-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public."order"
(
    id_order serial NOT NULL,
    date_order date NOT NULL,
    date_delivery date NOT NULL,
    fk_pickup_address integer,
    fk_userz integer,
    code_order integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 900 MINVALUE 900 MAXVALUE 2147483647 CACHE 1 ),
    fk_order_status integer,
    CONSTRAINT order_pkey PRIMARY KEY (id_order)
);

CREATE TABLE IF NOT EXISTS public.order_items
(
    id_order_items serial NOT NULL,
    fk_order integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    fk_article_product character varying(255) COLLATE pg_catalog."default" NOT NULL,
    quantity_items integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 0 MINVALUE 0 MAXVALUE 2147483647 CACHE 1 ),
    CONSTRAINT order_items_pkey PRIMARY KEY (id_order_items)
);

CREATE TABLE IF NOT EXISTS public.order_status
(
    id_order_status serial NOT NULL,
    name_order_status character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT order_status_pkey PRIMARY KEY (id_order_status)
);

CREATE TABLE IF NOT EXISTS public.pickup_address
(
    pickup_id serial NOT NULL,
    pickup_address character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT pickup_address_pkey PRIMARY KEY (pickup_id)
);

CREATE TABLE IF NOT EXISTS public.producer
(
    id_producer serial NOT NULL,
    name_producer character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT producer_pkey PRIMARY KEY (id_producer)
);

CREATE TABLE IF NOT EXISTS public.product
(
    article_product character varying(6) COLLATE pg_catalog."default" NOT NULL,
    fk_product_name integer,
    price_product bigint NOT NULL,
    fk_supplier integer,
    fk_producer integer,
    fk_product_category integer,
    discount_product integer,
    quantity_product bigint NOT NULL,
    description_product character varying(255) COLLATE pg_catalog."default",
    photo_product character varying(255) COLLATE pg_catalog."default",
    id_product serial NOT NULL,
    CONSTRAINT product_pkey PRIMARY KEY (id_product)
);

CREATE TABLE IF NOT EXISTS public.product_category
(
    id_product_category serial NOT NULL,
    name_product_category character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT product_category_pkey PRIMARY KEY (id_product_category)
);

CREATE TABLE IF NOT EXISTS public.product_name
(
    id_product_name serial NOT NULL,
    product_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT product_name_pkey PRIMARY KEY (id_product_name)
);

CREATE TABLE IF NOT EXISTS public.supplier
(
    id_supplier serial NOT NULL,
    name_supplier character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT supplier_pkey PRIMARY KEY (id_supplier)
);

CREATE TABLE IF NOT EXISTS public.user_role
(
    user_role_id serial NOT NULL,
    user_role character varying COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT user_role_pkey PRIMARY KEY (user_role_id)
);

CREATE TABLE IF NOT EXISTS public.users
(
    user_id integer NOT NULL DEFAULT nextval('userz_user_id_seq'::regclass),
    fk_user_role integer,
    user_name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    user_login character varying(255) COLLATE pg_catalog."default" NOT NULL,
    user_password character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT userz_pkey PRIMARY KEY (user_id)
);

ALTER TABLE IF EXISTS public."order"
    ADD CONSTRAINT fk_order_status FOREIGN KEY (fk_order_status)
    REFERENCES public.order_status (id_order_status) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."order"
    ADD CONSTRAINT fk_pickup_address FOREIGN KEY (fk_pickup_address)
    REFERENCES public.pickup_address (pickup_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public."order"
    ADD CONSTRAINT fk_userz FOREIGN KEY (fk_userz)
    REFERENCES public.users (user_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.order_items
    ADD CONSTRAINT fk_order FOREIGN KEY (fk_order)
    REFERENCES public."order" (id_order) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.product
    ADD CONSTRAINT fk_producer FOREIGN KEY (fk_producer)
    REFERENCES public.producer (id_producer) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.product
    ADD CONSTRAINT fk_product_category FOREIGN KEY (fk_product_category)
    REFERENCES public.product_category (id_product_category) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.product
    ADD CONSTRAINT fk_product_name FOREIGN KEY (fk_product_name)
    REFERENCES public.product_name (id_product_name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.product
    ADD CONSTRAINT fk_supplier FOREIGN KEY (fk_supplier)
    REFERENCES public.supplier (id_supplier) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.users
    ADD CONSTRAINT fk_user_role FOREIGN KEY (fk_user_role)
    REFERENCES public.user_role (user_role_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.users
    ADD CONSTRAINT userz_fk_user_role_fkey FOREIGN KEY (fk_user_role)
    REFERENCES public.user_role (user_role_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;